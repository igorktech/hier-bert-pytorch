# TODO: add custom tokenization to handle more than 2 segments
# Now processing is greedy